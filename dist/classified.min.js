(function(){var g=(typeof window!=='undefined'&&window)||(typeof exports!=='undefined'&&exports)||this;var f=g;var h=null;var j=false;var l=function(a,b){var c=function(){if(!j&&typeof this.initialize!=='undefined'){this.initialize.apply(this,arguments)}};if(b!=null){j=true;c.prototype=new b();for(var d in b){if(!m(d)){g.def(c,d,b[d])}}j=false}c.superclass=b;c.constructor=c;c.toString=function(){return a};return c};var k=function(a,b){if(a==null||b==null){return}var c=f;f=a;if(typeof b==='function'){b.call(a)}else{for(var d in b){g.def(d,b[d])}}f=c};var n=function(e,i){if(typeof i==='function'&&typeof e==='function'&&o(e)){return function(){var b=arguments,c=this.callSuper;this.callSuper=function(){var a=(arguments.length>0)?arguments:b;return i.apply(this,a)};var d=e.apply(this,b);this.callSuper=c;return d}}return e};var o=function(a){return(/\bcallSuper\b/).test(a.toString())};var m=function(a){return(/\b(prototype|superclass|constructor)\b/).test(a)};g.classify=function(){var a,b,c;if(arguments.length===3){c=arguments[0];a=arguments[1];b=arguments[2]}else{a=arguments[0];b=arguments[1]}if(typeof a==='string'){if(typeof f[a]==='undefined'){f[a]=l(a,c)}a=f[a]}var d=h;h=a.prototype;k(a,b);h=d;return a};g.def=function(){var a,b,c;if(arguments.length===3){a=arguments[0];b=arguments[1];c=arguments[2]}else{a=h||f;b=arguments[0];c=arguments[1]}c=n(c,a[b]);a[b]=c;return a[b]};g.module=function(a,b){if(typeof f[a]==='undefined'){f[a]={};f[a].toString=function(){return a}}k(f[a],b);return f[a]};g.include=function(){var a,b;if(arguments.length===2){a=arguments[0];b=arguments[1];if(typeof a==='string'){a=f[a]}}else{a=h||f;b=arguments[0]}k(a,b)};g.extend=function(){var a=h;h=null;g.include.apply(this,arguments);h=a};g.alias=function(a,b){var c=h||f;c[a]=c[b]}})();var $break={};module('Enumerable',function(){var i=function(a){return a};def('each',function(b,c){var d=0;try{this.__each__(function(a){b.call(c,a,d++)})}catch(error){if(error!=$break){throw error;}}return this});def('all',function(c,d){c=c||i;var e=true;this.each(function(a,b){e=e&&!!c.call(d,a,b);if(!e){throw $break;}});return e});alias('every','all');def('any',function(c,d){c=c||i;var e=false;this.each(function(a,b){if(e=!!c.call(d,a,b)){throw $break;}});return e});alias('some','any');def('collect',function(d,e){d=d||i;return this.inject([],function(a,b,c){a.push(d.call(e,b,c));return a})});alias('map','collect');def('detect',function(c,d){var e=null;this.each(function(a,b){if(c.call(d,a,b)){e=a;throw $break;}});return e});alias('find','detect');def('include',function(b){if(typeof this.indexOf==='function'){return this.indexOf(b)!=-1}var c=false;this.each(function(a){if(a==b){c=true;throw $break;}});return c});def('inject',function(c,d,e){this.each(function(a,b){c=d.call(e,c,a,b)});return c});alias('reduce','inject');def('reject',function(d,e){return this.inject([],function(a,b,c){if(!d.call(e,b,c)){a.push(b)}return a})});alias('not','reject');def('select',function(d,e){return this.inject([],function(a,b,c){if(d.call(e,b,c)){a.push(b)}return a})});alias('findAll','select');alias('filter','select')});classify(Array,function(){include(Enumerable);if(typeof Array.prototype.forEach==='undefined'){def('__each__',function(a){for(var b=0,c=this.length;b<c;b++){a.call(null,this[b])}})}else{alias('__each__','forEach')}if(typeof Array.prototype.indexOf==='undefined'){def('indexOf',function(a){for(var b=0,c=this.length;b<c;b++){if(this[b]===a){return b}}return-1})}if(typeof Array.prototype.lastIndexOf==='undefined'){def('lastIndexOf',function(a){var b=this.length;while(b--){if(this[b]===a){return b}}return-1})}def('clear',function(){this.length=0;return this});def('first',function(){return this[0]});def('last',function(){return this[this.length-1]});def('compact',function(){return this.reject(function(a){return a==null})});def('uniq',function(d){return this.inject([],function(a,b,c){if(c===0||(d?a.last()!=b:!a.include(b))){a.push(b)}return a})})});classify(Function,function(){def('bind',function(a){if(a==null){return this}var b=this;return function(){return b.apply(a,arguments)}})});classify(RegExp,function(){def(this,'escape',function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,'\\$1')})});classify(String,function(){def('camelize',function(){return this.replace(/[-_]+(.)?/g,function(a,b){return b?b.toUpperCase():''})});def('capitalize',function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()});def('dasherize',function(){return this.replace(/([A-Z]+)([A-Z][a-z])/g,'$1-$2').replace(/([a-z\d])([A-Z])/g,'$1-$2').replace(/_/g,'-').toLowerCase()});def('humanize',function(){return this.replace(/[_|-]+/g,' ').capitalize()});def('titleize',function(){return this.underscore().humanize().replace(/\b('?[a-z])/g,function(a,b){return b.capitalize()})});alias('toTitleCase','titleize');def('underscore',function(){return this.replace(/([A-Z]+)([A-Z][a-z])/g,'$1_$2').replace(/([a-z\d])([A-Z])/g,'$1_$2').replace(/-/g,"_").toLowerCase()})});